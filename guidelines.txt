# TODO:
* Test (test.py) to see if label representations are meaningful (different to zero).
  * We may need to have persistence with char_indices and maxlen.
  * Perhaps saving it after the model checkpoint has been saved,
    using the same prefix name.
* Improve sampling:
  * We can create meaningful data augmentation by corrupting
    labels in a natural way (e.g. misspellings, shortening, cropping, etc.).

* In DBpedia ontology there are ontological types and relations (30K in total).
* Model: map mentions to types or dbo-relations:
  * Data: dbpedia_ontology.nt, ~ 30K items.
  * Includes labels and comments/descriptions.
* Model: map mentions to dpedia resources (dbr).
  * Data: infobox_properties_en.ttl.bz2, ~3M unique items.
  * Includes: dbpedia.org/resource/<Name> where <Name> could be used as a large-coverage character match.
  * Data: labels_en.ttl.bz2, ~12M unique (?) items.
  * Includes: df-schema#label short English strings.
  * Data: nif_context_en.ttl.bz2, ~5M items.
  * Includes: isString large context (one big paragraph).
* Model: map mentions to dpedia properties (dbp).
  * Data: infobox_property_definitions_en.ttl.bz2, 60K items.
  * Includes: rdf-schema#label with a meaningful short English label.

# Instructions:

$ python ontology_prep.py dbpedia_ontology.nt > dbpedia_ontology.labels.jsonl

Outputs (~4K items):
{"role": "type", "uri": "dbo:LunarCrater", "label": "lunar crater"}
{"role": "type", "uri": "dbo:MotorsportSeason", "label": "motorsport season"}
...
{"role": "rel", "uri": "dbo:fansgroup", "label": "fansgroup"}
{"role": "rel", "uri": "dbo:population", "label": "population"}

$ python dbpedia_rels_prep.py infobox_property_definitions_en.ttl.bz2 > dbpedia_rels.labels.jsonl

Otputs (~60K items):
{"uri": "dbp:mostSuccessfulRiders", "label": "most successful riders"}
{"uri": "dbp:dateOfBuilt", "label": "date of built"}
...

$ python dbpedia_ents_prep.py infobox_properties_en.ttl.bz2 labels_en.ttl.bz2 nif_context_en.ttl.bz2 > dbpedia_ents.text.jsonl

Outputs (~13M items):
{"context": "Rarohenga is the underworld and realm of the spirits in M\u0101ori mythology. Inhabitants of Rarohenga are called turehu and are governed by Hine nui te Po.", "label": "Rarohenga", "surf": "Rarohenga", "uri": "dbr:Rarohenga"}
{"context": "", "label": "Saryesik Atyrau Desert", "surf": "Saryesik_Atyrau_Desert", "uri": "dbr:Saryesik_Atyrau_Desert"}
...

To compute entity linking:

$ echo "angelina jolie" | CUDA_VISIBLE_DEVICES=7 python el.py --model char-cnn_linkent_i1i1-i1i2s.check

Output:
{"label": "Angelina jolie", "uri": "dbr:Angelina_jolie", "score": 1.0}
{"label": "Angelina Jolie", "uri": "dbr:Angelina_Jolie", "score": 1.0}
{"label": "Angelina Jolie Trapdoor Spider", "uri": "dbr:Angelina_Jolie_Trapdoor_Spider", "score": 0.9935481548309326}
{"label": "Angelina Jolie Voight", "uri": "dbr:Angelina_Jolie_Voight", "score": 0.9934994578361511}
{"label": "Angelina Jolie cancer treatment", "uri": "dbr:Angelina_Jolie_cancer_treatment", "score": 0.9927096366882324}
{"label": "Angelina Jolie Pitt", "uri": "dbr:Angelina_Jolie_Pitt", "score": 0.9916501045227051}
{"label": "Angelina Joli", "uri": "dbr:Angelina_Joli", "score": 0.9904723167419434}
{"label": "Angelina Jolie Filmography", "uri": "dbr:Angelina_Jolie_Filmography", "score": 0.9891354441642761}
{"label": "Angelina Jolie filmography", "uri": "dbr:Angelina_Jolie_filmography", "score": 0.9891354441642761}
{"label": "Anjelina Jolie", "uri": "dbr:Anjelina_Jolie", "score": 0.9852608442306519}

